import{r as i,c as k,o as S,k as D,l as E,m as a,f as e,n as r,Q as p,p as d,aY as P,v as m,a2 as c,x as b,_ as u,ae as z,a0 as g,Z as f,af as A,ag as B,y as v,t as G}from"./index-DD84rciS.js";import{a as y}from"./QItemLabel-Y1e7J-9n.js";import{Q as T}from"./QTooltip-D3K5a0T4.js";import{Q as I}from"./QSelect-D9KbhcM8.js";import{Q as F}from"./QForm-DwmnhYBt.js";import{Q as j}from"./QTable-B6mhboVn.js";import{Q as L}from"./QPage-BB2Um8dJ.js";import{_ as M}from"./FormTercero-C-LO8pTD.js";import"./axios-DO-4OFiN.js";import"./format-DyQxkAtJ.js";import"./QVirtualScroll-DljW3BAz.js";import"./QList-BWY4JASi.js";import"./QMarkupTable-DvZ2xV1r.js";import"./Utils-DJ7xQ2GR.js";const $={class:"row items-center q-gutter-sm"},Y={class:"row q-col-gutter-md"},Z={class:"col-12 col-md-5"},H={class:"row items-center q-gutter-sm"},J={class:"col-12 col-md-7"},K={class:"row items-center q-gutter-sm"},O={class:"items-center q-pa-sm bg-grey-2 rounded-borders"},W={class:"row justify-end q-gutter-sm q-mt-md"},pe={__name:"GestionPersonal",setup(X){i({Nombre:"",Identificacion:"",Telefono:"",Correo:"",Tipo:""});const Q=i([]),U=i(""),x=i(null),_=i({}),n=i({NombreUsuario:"",IdRol:null}),C=i([]),w=i([]);k(()=>Q.value.filter(l=>{var o;return(o=l.Nombre)==null?void 0:o.toLowerCase().includes(U.value.toLowerCase())}));const N=l=>{mostrarDialogoTercero.value=!1,Utils.notificacion(l.Mensaje,l.IsExito)},V=[{name:"Nombre",label:"Tercero",field:"NombreTercero"},{name:"Usuario",label:"Usuario",field:"NombreUsuario"},{name:"Rol",label:"Rol",field:"Rol"},{name:"acciones",label:"Acciones",field:"acciones",align:"right"}],q=l=>{Tercero.value=l},R=async(l,o)=>{if(!(!l||l.trim()===""))try{const s=await Utils.peticion("GET",`tercero/${Usuario.value.IdEmpresa}/empresa/${l}/filtro`);o(()=>{var t;Terceros.value=((t=s.data)==null?void 0:t.Dato)||[]})}catch(s){console.error("Error al filtrar:",s)}};return S(async()=>{}),(l,o)=>(E(),D(L,{style:{height:"calc(100vh - 60px)",overflow:"auto","background-color":"#EBEBF0"},class:"q-pa-sm"},{default:a(()=>[e(p,{flat:"",bordered:"",class:"q-mb-md"},{default:a(()=>[e(d,{class:"bg-blue-grey-3 text-white q-pa-md"},{default:a(()=>[r("div",$,[e(P,{size:"56px",color:"white","text-color":"primary"},{default:a(()=>[e(m,{name:"groups",size:"32px"})]),_:1}),o[5]||(o[5]=r("div",null,[r("div",{class:"text-h5 text-grey-9"},"Gestión de Terceros y Usuarios"),r("div",{class:"text-caption text-grey-9"},"Administra cuentas de acceso al sistema")],-1))])]),_:1})]),_:1}),r("div",Y,[r("div",Z,[e(p,{flat:"",bordered:""},{default:a(()=>[e(d,{class:"bg-blue-grey-3 text-white"},{default:a(()=>[r("div",H,[e(m,{name:"badge",color:"grey-9",size:"24px"}),o[6]||(o[6]=r("div",null,[r("div",{class:"text-subtitle2 text-grey-9"},"Registro de Terceros"),r("div",{class:"text-caption text-grey-9"},"Crear / Editar cliente o proveedor")],-1))])]),_:1}),e(c),e(d,{class:"q-pa-md"},{default:a(()=>[e(M,{class:"q-pa-md",terceroData:_.value,isDialogActivado:!0,onTerceroGuardado:N},null,8,["terceroData"])]),_:1}),e(c)]),_:1})]),r("div",J,[e(p,{flat:"",bordered:""},{default:a(()=>[e(d,{class:"bg-blue-grey-3 text-white"},{default:a(()=>[r("div",K,[e(m,{name:"admin_panel_settings",color:"grey-9",size:"24px"}),o[7]||(o[7]=r("div",null,[r("div",{class:"text-subtitle2 text-grey-9"},"Usuarios del Sistema"),r("div",{class:"text-caption text-grey-9"},"Asignar accesos y roles")],-1))])]),_:1}),e(c),e(d,{class:"q-pa-md"},{default:a(()=>[e(F,{onSubmit:o[4]||(o[4]=()=>{}),class:"q-gutter-md"},{default:a(()=>[e(I,{flat:"",outlined:"",ref:"EmpleadoRef",clearable:"",onClear:l.limpiarTercero,"onUpdate:modelValue":[q,o[1]||(o[1]=s=>l.Tercero=s)],class:"col-md-6 col-sm-12 col-xs-12 col-lg-6","hide-bottom-space":"",modelValue:l.Tercero,color:"grey","option-label":"NombreCompleto","use-input":"","emit-value":"","map-options":"",label:"Tercero",disable:l.CamposDisables,options:l.Terceros,onFilter:R},{option:a(s=>[e(g,A(B(s.itemProps)),{default:a(()=>[e(f,{avatar:""},{default:a(()=>[e(m,{name:"person"})]),_:1}),e(f,null,{default:a(()=>[e(y,{class:"text-body1"},{default:a(()=>{var t;return[u(v(((t=s.opt)==null?void 0:t.NombreCompleto)||"Sin nombre"),1)]}),_:2},1024),e(y,{caption:""},{default:a(()=>{var t;return[u(v(((t=s.opt)==null?void 0:t.Identificacion)||"---"),1)]}),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":a(()=>[e(g,null,{default:a(()=>[e(f,{class:"text-grey-10"},{default:a(()=>[...o[8]||(o[8]=[u("Sin resultados",-1)])]),_:1})]),_:1})]),after:a(()=>[r("div",O,[e(b,{flat:"",round:"",dense:"",icon:"group_add",color:"primary",onClick:l.abrirFormularioTercero,disable:l.CamposDisables},{default:a(()=>[e(T,{class:"bg-black",offset:[10,10]},{default:a(()=>[...o[9]||(o[9]=[u(" Agregar Tercero ",-1)])]),_:1})]),_:1},8,["onClick","disable"]),e(z,{disable:l.CamposDisablesEdit,modelValue:l.IsInterno,"onUpdate:modelValue":[o[0]||(o[0]=s=>l.IsInterno=s),l.ManejarPeticionInterna],label:"Interna",color:"primary",size:"sm",class:"text-caption q-mt-xs","left-label":""},{default:a(()=>[e(T,{class:"bg-black",offset:[10,10]},{default:a(()=>[...o[10]||(o[10]=[u(" Petición Interna ",-1)])]),_:1})]),_:1},8,["disable","modelValue","onUpdate:modelValue"])])]),_:1},8,["onClear","modelValue","disable","options"]),e(G,{outlined:"",dense:"",modelValue:n.value.NombreUsuario,"onUpdate:modelValue":o[2]||(o[2]=s=>n.value.NombreUsuario=s),label:"Nombre de usuario"},null,8,["modelValue"]),e(I,{outlined:"",dense:"",modelValue:n.value.IdRol,"onUpdate:modelValue":o[3]||(o[3]=s=>n.value.IdRol=s),label:"Rol de acceso","option-value":"IdRol","option-label":"Nombre",options:w.value},null,8,["modelValue","options"]),r("div",W,[e(b,{flat:"",label:"Cancelar",color:"grey-8",icon:"close",onClick:l.limpiarUsuario},null,8,["onClick"]),e(b,{unelevated:"",type:"submit",label:"Guardar Usuario",color:"primary",icon:"save",disable:!x.value||!n.value.NombreUsuario||!n.value.IdRol},null,8,["disable"])])]),_:1})]),_:1}),e(c),e(d,null,{default:a(()=>[e(j,{columns:V,rows:C.value,"row-key":"IdUsuario",flat:"",dense:""},{"body-cell-acciones":a(s=>[...o[11]||(o[11]=[])]),_:1},8,["rows"])]),_:1})]),_:1})])])]),_:1}))}};export{pe as default};
