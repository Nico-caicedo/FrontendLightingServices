import{Q as n}from"./QSelect-D9KbhcM8.js";import{r as d,w as T,o as N,k as U,l as x,m as A,n as c,f as r,z as t,t as s,x as m,q as E,ac as z}from"./index-DD84rciS.js";import{Q as D}from"./QForm-DwmnhYBt.js";import{api as p}from"./axios-DO-4OFiN.js";import{U as i}from"./Utils-DJ7xQ2GR.js";const w={class:"row q-col-gutter-md"},Q={class:"q-mt-md flex justify-end"},F={__name:"FormTercero",props:{terceroData:{type:Object,default:()=>({})},isDialogActivado:{type:Boolean,default:!1}},emits:["tercero-guardado","tercero-modificado"],setup(f,{emit:v}){const I=f,u=d({}),b=v,e=d({IdTipoIdentificacion:null,Identificacion:"",Nombres:"",Apellido1:"",Apellido2:"",Correo:"",Telefono:"",NombreCompleto:"",Direccion:"",IdEmpresa:"",IdBarrio:"",IdUsuarioC:""}),V=()=>{e.value={IdTipoIdentificacion:null,Identificacion:"",Nombres:"",Apellido1:"",Apellido2:"",Correo:"",Telefono:"",NombreCompleto:"",Direccion:"",IdEmpresa:"",IdBarrio:"",IdUsuarioC:""}},g=[{label:"Cédula de Ciudadanía",value:1},{label:"NIT",value:2},{label:"Cédula de Extranjería",value:3},{label:"Pasaporte",value:4}],C=d([{IdBarrio:1,NombreBarrio:"Centro"},{IdBarrio:2,NombreBarrio:"La Esperanza"},{IdBarrio:3,NombreBarrio:"Las Flores"}]),y=async()=>{if(!e.value.Identificacion)return!1;try{const o=await p.post(`/tercero/${e.value.Identificacion}/validar-identificacion`);return o.data.IsExito?!0:(i.notificacion("La identificación ya se encuentra registrada.",o.data.IsExito),e.value.Identificacion="",!1)}catch(o){return console.error(o),z.create({message:"❌ Error al validar identificación",color:"negative",position:"top"}),!1}};T(()=>I.terceroData,o=>{o&&Object.assign(e.value,o)},{immediate:!0});const B=async()=>{console.log("aludo"),e.value.IdUsuarioC=u.value.IdUsuario,e.value.IdEmpresa=u.value.IdEmpresa,console.log(e.value);const o=await p.post("/tercero/crear-tercero",e.value);i.notificacion(o.data.Mensaje,o.data.IsExito),e.value={IdTipoIdentificacion:null,Identificacion:"",Nombres:"",Apellido1:"",Apellido2:"",Correo:"",Telefono:"",NombreCompleto:"",Direccion:"",IdEmpresa:"",IdBarrio:"",IdUsuarioC:""},b("tercero-guardado",o.data)};return N(async()=>{try{const o=await i.datoUsuario();if(!o){router.push("/Login");return}u.value=o}catch(o){console.error(o)}}),(o,l)=>(x(),U(D,{onSubmit:E(B,["prevent"]),class:"q-gutter-md"},{default:A(()=>[c("div",w,[r(n,{modelValue:e.value.IdTipoIdentificacion,"onUpdate:modelValue":l[0]||(l[0]=a=>e.value.IdTipoIdentificacion=a),options:g,label:"Tipo de Identificación","option-label":"label","emit-value":"","map-options":"","option-value":"value",class:"col-12 col-md-6",outlined:"","lazy-rules":"",rules:[t(i).reglaSelect]},null,8,["modelValue","rules"]),r(s,{modelValue:e.value.Identificacion,"onUpdate:modelValue":l[1]||(l[1]=a=>e.value.Identificacion=a),label:"Identificación",class:"col-12 col-md-6",outlined:"",onBlur:y},null,8,["modelValue"]),r(s,{modelValue:e.value.Nombres,"onUpdate:modelValue":l[2]||(l[2]=a=>e.value.Nombres=a),label:"Nombres",class:"col-12 col-md-6",outlined:"","lazy-rules":"",rules:[t(i).reglaTexto]},null,8,["modelValue","rules"]),r(s,{modelValue:e.value.Apellido1,"onUpdate:modelValue":l[3]||(l[3]=a=>e.value.Apellido1=a),label:"Primer Apellido",class:"col-12 col-md-6",outlined:"","lazy-rules":"",rules:[t(i).reglaTexto]},null,8,["modelValue","rules"]),r(s,{modelValue:e.value.Apellido2,"onUpdate:modelValue":l[4]||(l[4]=a=>e.value.Apellido2=a),label:"Segundo Apellido",class:"col-12 col-md-6",outlined:"","lazy-rules":"",rules:[t(i).reglaTexto]},null,8,["modelValue","rules"]),r(s,{modelValue:e.value.Correo,"onUpdate:modelValue":l[5]||(l[5]=a=>e.value.Correo=a),label:"Correo",type:"email",class:"col-12 col-md-6",outlined:"","lazy-rules":"",rules:[t(i).reglaTexto]},null,8,["modelValue","rules"]),r(s,{modelValue:e.value.Telefono,"onUpdate:modelValue":l[6]||(l[6]=a=>e.value.Telefono=a),label:"Teléfono",class:"col-12 col-md-6",outlined:"","lazy-rules":"",rules:[t(i).reglaNumero]},null,8,["modelValue","rules"]),r(s,{modelValue:e.value.Direccion,"onUpdate:modelValue":l[7]||(l[7]=a=>e.value.Direccion=a),label:"Dirección",class:"col-12 col-md-6",outlined:"","lazy-rules":"",rules:[t(i).reglaTexto]},null,8,["modelValue","rules"]),r(n,{modelValue:e.value.IdBarrio,"onUpdate:modelValue":l[8]||(l[8]=a=>e.value.IdBarrio=a),options:C.value,"option-label":"NombreBarrio","option-value":"IdBarrio",label:"Barrio",class:"col-12 col-md-6",outlined:"","emit-value":"","map-options":"","lazy-rules":"",rules:[t(i).reglaSelect]},null,8,["modelValue","options","rules"])]),c("div",Q,[r(m,{flat:"",label:"Cancelar",color:"black",onClick:V}),r(m,{label:"Guardar",color:"grey-7",type:"submit",class:"q-ml-sm"})])]),_:1}))}};export{F as _};
