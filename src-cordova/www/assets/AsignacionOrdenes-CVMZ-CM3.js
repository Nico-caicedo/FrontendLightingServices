import{Q as z,a as b,b as A,c as x}from"./QTabPanels-9LAV1XNd.js";import{a4 as D,u as G,r as s,o as K,k as L,l as j,m as t,f as a,n as r,Q as M,t as V,ay as H,x as B,a9 as E,aa as w,a6 as y,ar as J,as as W,v as X,y as O,ao as Y}from"./index-D5vjZng5.js";import{Q as R}from"./QTable-BEUxk8-q.js";import{Q as T}from"./QMarkupTable-D_s8XBCj.js";import{a as _}from"./selection-DN5zOXK0.js";import{Q as Z}from"./QPage-BJi1r_Vy.js";import{api as v}from"./axios-CEIDL2YN.js";import{_ as ee}from"./EncabezadoParametros-fnNhZ8Qc.js";import{U as u}from"./Utils-Bl6bKBe-.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QResizeObserver-CYkWCT8D.js";import"./touch-BjYP5sR0.js";import"./format-DyQxkAtJ.js";import"./use-quasar-BKhMSG19.js";const oe={class:"row q-pa-sm"},le={class:"full-width row q-pa-md q-pt-md q-pb-md br-circle"},se={class:"q-gutter-sm"},te={class:"row col-12 q-gutter-sm"},re={class:"row q-col-gutter-md"},ne={__name:"AsignacionOrdenes",setup(ie){D();const k=G(),q=s(!0),c=s("asignar"),U=s([]),I=s([]),Q=s(!1),i=s([]),C=s(!1),n=s({}),d=s({texto:"",fechaInicio:"",fechaFin:""}),F=[{name:"CodigoRadicado",align:"center",label:"Código PQRS",field:"CodigoRadicado",sortable:!0},{name:"Usuario",align:"center",label:"Usuario",field:"Usuario",sortable:!0},{name:"FechaCFechaRadicadoreacion",align:"center",label:"Fecha",field:"FechaRadicado",format:l=>u.formatearFecha(l)},{name:"Telefono",align:"center",label:"Teléfono",field:"Telefono"},{name:"Barrio",align:"center",label:"Barrio",field:"Barrio"},{name:"Direccion",align:"center",label:"Dirección",field:"Direccion"},{name:"CreadorOrden",align:"center",label:"Creador Orden",field:"CreadorOrden"}];s(!1),s(!1),s(null),s([]);const P=s([]),g=s([]),m=s(null),p=s(null);s(!1),s(null);const N=async l=>{if(!l){g.value=[];return}try{const e=await u.peticion("GET",`usuario/${l}/${n.value.IdEmpresa}/usuario-por-cargo`);g.value=e.data||[]}catch(e){console.error("Error al filtrar usuarios por cargo:",e)}},S=async()=>{const l=await v.get(`/ordenservicio/${n.value.IdEmpresa}/traer-cargos-empresa`);P.value=l.data},h=async()=>{const l=[];console.log(i.value),i.value.forEach(o=>{l.push({IdPqrs:o.IdPqrs,IdUsuarioA:n.value.IdUsuario,IdUsuario:p.value})}),console.log(l);const e=await v.post("/ordenservicio/asignar-tecnicos-orden",l);u.notificacion("Se asginaron ordenes",e.data.IsExito),u.loadingNotify(!1,""),f(),m.value="",p.value=""},f=async()=>{console.log(n.value);const l=await v.get(`/ordenservicio/${n.value.IdEmpresa}/1/traer-ordenes-empresa-estado`);U.value=l.data,console.log()},$=async()=>{console.log(n.value);const l=await v.get(`/ordenservicio/${n.value.IdEmpresa}/3/traer-ordenes-empresa-estado`);I.value=l.data,console.log()};return K(async()=>{try{const l=await u.datoUsuario();if(!l){k.push("/Login");return}n.value=l}catch(l){console.error(l)}f(),$(),S()}),(l,e)=>(j(),L(Z,{style:{height:"calc(100vh - 55px)",overflow:"auto","background-color":"#EBEBF0"}},{default:t(()=>[a(ee,{parteUno:"Gestión",parteDos:"Órdenes"},{botones:t(()=>[...e[10]||(e[10]=[])]),_:1}),r("section",oe,[r("main",le,[a(M,{class:"full-width"},{default:t(()=>[a(z,{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=o=>c.value=o),dense:"",class:"bg-grey-4 text-white-7","active-color":"primary","indicator-color":"black",align:"justify"},{default:t(()=>[a(b,{name:"asignar",label:"Asignar Órdenes"}),a(b,{name:"verificacion",label:"Ordenes Pendientes"}),a(b,{name:"finalizadas",label:"Órdenes Finalizadas"})]),_:1},8,["modelValue"]),a(A,{modelValue:c.value,"onUpdate:modelValue":e[8]||(e[8]=o=>c.value=o),animated:""},{default:t(()=>[a(x,{name:"asignar"},{default:t(()=>[e[12]||(e[12]=r("p",{class:"text-center text-h5"},"Asignar Orden",-1)),r("div",se,[r("div",te,[a(V,{modelValue:d.value.texto,"onUpdate:modelValue":e[1]||(e[1]=o=>d.value.texto=o),filled:"",label:"Buscar por número o usuario",class:"col-xs-12 col-sm-6 col-md-5 col-lg",onKeyup:H(f,["enter"])},null,8,["modelValue"]),a(V,{modelValue:d.value.fechaInicio,"onUpdate:modelValue":e[2]||(e[2]=o=>d.value.fechaInicio=o),filled:"",type:"date",label:"Fecha Inicio",class:"col-xs-12 col-sm-6 col-md-3 col-lg"},null,8,["modelValue"]),a(V,{modelValue:d.value.fechaFin,"onUpdate:modelValue":e[3]||(e[3]=o=>d.value.fechaFin=o),filled:"",type:"date",label:"Fecha Fin",class:"col-xs-12 col-sm-6 col-md-3 col-lg"},null,8,["modelValue"]),a(B,{color:"primary",label:"Buscar",icon:"search",onClick:f,class:"col-xs-12 col-sm-2"})]),a(R,{flat:"",bordered:"",title:"Órdenes",rows:U.value,columns:F,"row-key":"CodigoRadicado",selection:"multiple",selected:i.value,"onUpdate:selected":e[4]||(e[4]=o=>i.value=o),loading:C.value,"no-data-label":"No se encontraron órdenes"},null,8,["rows","selected","loading"]),r("div",re,[a(T,{modelValue:m.value,"onUpdate:modelValue":[e[5]||(e[5]=o=>m.value=o),N],options:P.value,"option-label":"Nombre","option-value":"IdRol",label:"Cargo",clearable:"","emit-value":"","map-options":"",class:"col-6"},null,8,["modelValue","options"]),a(T,{modelValue:p.value,"onUpdate:modelValue":e[6]||(e[6]=o=>p.value=o),options:g.value,"option-label":"NombreCompleto","option-value":"IdUsuario",label:"Usuario","use-input":"","emit-value":"","map-options":"",clearable:"",class:"col-6",disable:!m.value,onFilter:l.filtrarUsuarios},{option:t(o=>[a(E,J(W(o.itemProps)),{default:t(()=>[a(w,{avatar:""},{default:t(()=>[a(X,{name:"person"})]),_:1}),a(w,null,{default:t(()=>[a(_,null,{default:t(()=>[y(O(o.opt.NombreCompleto),1)]),_:2},1024),a(_,{caption:""},{default:t(()=>[y(O(o.opt.Identificacion),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":t(()=>[a(E,null,{default:t(()=>[a(w,{class:"text-grey-10"},{default:t(()=>[...e[11]||(e[11]=[y("Sin resultados",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","onFilter"])]),a(B,{onClick:h,label:"Asignar ordenes",color:"black"})])]),_:1}),a(x,{name:"verificacion"},{default:t(()=>[e[13]||(e[13]=r("p",{class:"text-center text-h5"},"Ordenes Pendientes",-1)),a(R,{flat:"",bordered:"",title:"Órdenes",rows:I.value,columns:F,"row-key":"CodigoRadicado",selection:"multiple",selected:i.value,"onUpdate:selected":e[7]||(e[7]=o=>i.value=o),loading:C.value,"no-data-label":"No se encontraron órdenes"},null,8,["rows","selected","loading"])]),_:1}),a(x,{name:"finalizadas"},{default:t(()=>[...e[14]||(e[14]=[r("p",{class:"text-center text-h5"},"Órdenes finalizadas",-1),r("p",{class:"text-h6 text-grey"},"Próximamente",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),a(Y,{modelValue:Q.value,"onUpdate:modelValue":e[9]||(e[9]=o=>Q.value=o),"full-width":"",maximized:q.value,persistent:""},null,8,["modelValue","maximized"])]),_:1}))}},Ie=ae(ne,[["__scopeId","data-v-92cdc2d3"]]);export{Ie as default};
